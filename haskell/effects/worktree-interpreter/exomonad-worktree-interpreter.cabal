cabal-version:      3.0
name:               exomonad-worktree-interpreter
version:            0.1.0.0
synopsis:           Worktree effect interpreter - git worktree management
description:
    Implements Worktree effect by calling git commands.
    .
    Enables graphs to manage isolated git worktrees for parallel agent execution.
    Each worktree gets its own branch and working directory, allowing multiple
    Claude Code sessions to work in parallel without conflicts.
license:            MIT
author:             Inanna
build-type:         Simple

common warnings
    ghc-options: -Wall -Wincomplete-patterns -Wredundant-constraints -Wunused-packages -fplugin=Polysemy.Plugin

library
    import:           warnings
    exposed-modules:
        ExoMonad.Worktree.Interpreter
    build-depends:
        base >= 4.17 && < 5,
        polysemy >= 1.9,
        polysemy-plugin >= 0.4,
        text >= 2.0 && < 3,
        process >= 1.6 && < 2,
        filepath >= 1.4 && < 2,
        directory >= 1.3 && < 2,
        random >= 1.2 && < 2,
        exomonad-core
    hs-source-dirs:   src
    default-language: GHC2024
    default-extensions:
        DataKinds
        DeriveGeneric
        DerivingStrategies
        GADTs
        LambdaCase
        OverloadedStrings
        OverloadedRecordDot
        TypeFamilies
        TypeOperators
        NoFieldSelectors

test-suite worktree-interpreter-test
    type:             exitcode-stdio-1.0
    main-is:          Main.hs
    other-modules:
        ExoMonad.Worktree.ParseSpec
        ExoMonad.Worktree.InterpreterSpec
    hs-source-dirs:   test
    default-language: GHC2024
    default-extensions:
        OverloadedStrings
        OverloadedRecordDot
    build-depends:
        base >= 4.17 && < 5,
        exomonad-core,
        exomonad-worktree-interpreter,
        polysemy >= 1.9,
        polysemy-plugin >= 0.4,
        filepath >= 1.4 && < 2,
        directory >= 1.3 && < 2,
        process >= 1.6 && < 2,
        text >= 2.0 && < 3,
        hspec >= 2.10 && < 3
    ghc-options:      -threaded -rtsopts -with-rtsopts=-N -fplugin=Polysemy.Plugin
