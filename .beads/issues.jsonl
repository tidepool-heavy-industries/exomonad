{"id":"tidepool-6qa","title":"urchin prime: worktree-aware context generator","description":"Build a CLI tool that generates focused context for Claude Code sessions based on current worktree, bd state, and project context. Inspired by gastown's gt prime.\n\n## Workflow Model\n\n```\n┌─────────────────────────────────────────────────────────┐\n│  open → in_progress → in_review → closed                │\n│                                                         │\n│  1. bd ready / hooked    → Find work (propulsion first) │\n│  2. bd update X -s in_progress → Claim                  │\n│  3. Implement            → Guided by bead spec          │\n│  4. gh pr create         → File PR                      │\n│  5. bd label add X pr:N  → Link PR to bead              │\n│  6. bd update X -s in_review → Awaiting merge           │\n│  7. [next session]                                      │\n│  8. urchin prime         → Polls GitHub for in_review   │\n│  9. If PR merged         → bd close X, add 'merged'     │\n│ 10. Loop                                                │\n└─────────────────────────────────────────────────────────┘\n```\n\n## Design Decisions\n\n1. **PR Linkage**: Labels track state\n   - Add `pr:123` label when PR created\n   - Add `merged` label on merge\n   - Beads stay in_review until merge confirmed\n\n2. **Review State**: New status `in_review`\n   - Pipeline: open → in_progress → in_review → closed\n   - Explicit state for \"PR filed, awaiting merge\"\n\n3. **Session Handoff**: urchin prime polls GitHub\n   - Check PR status for in_review beads\n   - Auto-close if PR merged\n   - Update context for next session\n\n4. **Task Discovery**: Propulsion principle\n   - If hooked work exists → that's THE task, go\n   - Otherwise → `bd ready` shows unblocked work\n   - Agent picks based on context\n\n## Implementation Phases\n\nPhase 1 (this epic): Core urchin prime CLI\nPhase 2: GitHub polling for PR status  \nPhase 3: Hooks integration for auto-context injection","status":"open","priority":2,"issue_type":"epic","created_at":"2026-01-04T16:42:22.09033911-08:00","created_by":"inanna","updated_at":"2026-01-04T16:58:20.005333567-08:00","labels":["pr:131"]}
{"id":"tidepool-6qa.1","title":"Implement WorktreeInfo type and git detection","description":"Create Tidepool/BD/Prime/Worktree.hs with git worktree detection.\n\n## Types\n\n```haskell\ndata WorktreeInfo = WorktreeInfo\n  { wiName     :: Text      -- \"bd\", \"native-server\", etc (from path)\n  , wiPath     :: FilePath  -- /home/.../worktrees/bd\n  , wiBranch   :: Text      -- feat/bd (current branch)\n  , wiRepoRoot :: FilePath  -- /home/.../tidepool (git root)\n  }\n```\n\n## Functions\n\n- `detectWorktree :: IO (Maybe WorktreeInfo)` - Parse `git worktree list --porcelain`\n- `detectFromCwd :: IO (Maybe WorktreeInfo)` - Detect from current directory\n- `worktreeName :: FilePath -\u003e Text` - Extract name from path (last component of worktrees/X)\n\n## Git Commands Used\n\n```bash\ngit worktree list --porcelain  # Get all worktrees\ngit rev-parse --show-toplevel  # Get repo root\ngit branch --show-current      # Get current branch\n```\n\n## Acceptance Criteria\n\n- [ ] Detects main repo vs worktree correctly\n- [ ] Handles case when not in a git repo (returns Nothing)\n- [ ] Extracts worktree name from path","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-04T16:42:35.464053029-08:00","created_by":"inanna","updated_at":"2026-01-04T17:02:56.577203589-08:00","closed_at":"2026-01-04T17:02:56.577203589-08:00","close_reason":"Implemented WorktreeInfo type and detectWorktree function in Tidepool.BD.Prime.Worktree","dependencies":[{"issue_id":"tidepool-6qa.1","depends_on_id":"tidepool-6qa","type":"parent-child","created_at":"2026-01-04T16:42:35.470993518-08:00","created_by":"inanna"}]}
{"id":"tidepool-6qa.2","title":"Implement PrimeContext and context gathering","description":"Create Tidepool/BD/Prime.hs with context aggregation and rendering.\n\n## Types\n\n```haskell\ndata PrimeContext = PrimeContext\n  { pcWorktree      :: WorktreeInfo\n  , pcBranch        :: Text\n  , pcDirtyFiles    :: [FilePath]\n  , pcRecentCommits :: [Text]        -- Last 5 commits (subject only)\n  , pcInProgress    :: [BeadInfo]    -- status=in_progress\n  , pcReady         :: [BeadInfo]    -- Unblocked, status=open\n  , pcHooked        :: [BeadInfo]    -- status=hooked (propulsion)\n  , pcEpicContext   :: Maybe BeadInfo -- Epic matching worktree name\n  }\n\ndata EpicMatch = EpicMatch\n  { emEpic     :: BeadInfo\n  , emChildren :: [BeadInfo]\n  }\n```\n\n## Functions\n\n- `gatherContext :: BDConfig -\u003e WorktreeInfo -\u003e IO PrimeContext`\n  - Query bd for in_progress, ready (open + unblocked), hooked\n  - Get recent commits via `git log --oneline -5`\n  - Get dirty files via `git status --porcelain`\n  - Find epic by label or title matching worktree name\n\n- `renderPrime :: PrimeContext -\u003e Text`\n  - Markdown output with sections for git status, in-progress, ready, propulsion\n\n## BD Queries\n\n```bash\nbd list --status=in_progress --json\nbd list --status=open --json        # Then filter unblocked\nbd list --status=hooked --json\nbd list --type=epic --json          # Find matching epic\n```\n\n## Output Template\n\n```markdown\n# Urchin Prime: {worktree} / {branch}\n\n## Git Status\n- Branch: {branch}\n- Dirty: {count} files\n- Recent: {last_commit}\n\n## In Progress ({count})\n- [id] title (P{priority})\n\n## Ready ({count})\n- [id] title\n\n## Propulsion\n{if hooked} **HOOKED**: {title} - proceed immediately\n{else} No hooked work. Review Ready tasks.\n```","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-04T16:42:35.843612226-08:00","created_by":"inanna","updated_at":"2026-01-04T17:05:41.247470777-08:00","closed_at":"2026-01-04T17:05:41.247470777-08:00","close_reason":"Implemented PrimeContext, gatherContext, and renderPrime in Tidepool.BD.Prime","dependencies":[{"issue_id":"tidepool-6qa.2","depends_on_id":"tidepool-6qa","type":"parent-child","created_at":"2026-01-04T16:42:35.84433155-08:00","created_by":"inanna"},{"issue_id":"tidepool-6qa.2","depends_on_id":"tidepool-6qa.1","type":"blocks","created_at":"2026-01-04T16:42:46.475040561-08:00","created_by":"inanna"}]}
{"id":"tidepool-6qa.3","title":"Add 'prime' subcommand to urchin CLI","description":"Add 'prime' subcommand to bd-executor CLI.\n\n## CLI Interface\n\n```bash\nurchin prime                      # Auto-detect worktree, markdown output\nurchin prime --worktree=bd        # Explicit worktree\nurchin prime --format=json        # JSON for MCP/programmatic use\nurchin prime --format=markdown    # Default\nurchin prime --epic=tidepool-6qa  # Focus on specific epic's children\n```\n\n## Implementation\n\n1. Add to optparse-applicative parser in Main.hs\n2. Wire to Prime.gatherContext + Prime.renderPrime\n3. Support OutputFormat enum (Markdown | JSON)\n\n## Data Types\n\n```haskell\ndata PrimeOptions = PrimeOptions\n  { poWorktree :: Maybe Text      -- Override auto-detection\n  , poFormat   :: OutputFormat    -- markdown | json\n  , poEpic     :: Maybe Text      -- Focus on epic's children\n  }\n\ndata OutputFormat = FormatMarkdown | FormatJSON\n```\n\n## JSON Output Schema\n\n```json\n{\n  \"worktree\": { \"name\": \"bd\", \"path\": \"...\", \"branch\": \"feat/bd\" },\n  \"git\": { \"dirty_count\": 2, \"recent_commit\": \"...\" },\n  \"in_progress\": [{ \"id\": \"...\", \"title\": \"...\", \"priority\": 2 }],\n  \"ready\": [...],\n  \"hooked\": [...],\n  \"epic\": { \"id\": \"...\", \"title\": \"...\", \"children\": [...] }\n}\n```\n\n## Acceptance Criteria\n\n- [ ] `urchin prime` works from any worktree\n- [ ] `--format=json` produces valid JSON\n- [ ] `--worktree` override works\n- [ ] Graceful error when not in git repo","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-04T16:42:36.222947151-08:00","created_by":"inanna","updated_at":"2026-01-04T17:07:24.74045596-08:00","closed_at":"2026-01-04T17:07:24.74045596-08:00","close_reason":"Implemented urchin CLI with prime subcommand - markdown and JSON output working","dependencies":[{"issue_id":"tidepool-6qa.3","depends_on_id":"tidepool-6qa","type":"parent-child","created_at":"2026-01-04T16:42:36.223662511-08:00","created_by":"inanna"},{"issue_id":"tidepool-6qa.3","depends_on_id":"tidepool-6qa.2","type":"blocks","created_at":"2026-01-04T16:42:46.622833898-08:00","created_by":"inanna"}]}
{"id":"tidepool-6qa.4","title":"Write tests for urchin prime","description":"Write tests for urchin prime functionality.\n\n## Test Categories\n\n### Unit Tests (Worktree.hs)\n\n- `detectWorktree` with mocked git output\n- `worktreeName` extracts correct name from various paths\n- Handles non-git directories gracefully\n\n### Unit Tests (Prime.hs)\n\n- `renderPrime` golden tests for markdown output\n- Empty state handling (no in-progress, no ready, no hooked)\n- Propulsion section appears only when hooked work exists\n\n### Integration Tests\n\n- Run `urchin prime` in actual bd worktree\n- Verify JSON output parses correctly\n- Verify markdown contains expected sections\n\n## Test Data\n\n```haskell\ntestWorktree :: WorktreeInfo\ntestWorktree = WorktreeInfo\n  { wiName = \"bd\"\n  , wiPath = \"/home/test/tidepool/worktrees/bd\"\n  , wiBranch = \"feat/bd\"\n  , wiRepoRoot = \"/home/test/tidepool\"\n  }\n\ntestContext :: PrimeContext\ntestContext = PrimeContext\n  { pcWorktree = testWorktree\n  , pcInProgress = [mockBead \"tidepool-1\" \"Task 1\" 2]\n  , pcReady = [mockBead \"tidepool-2\" \"Task 2\" 3]\n  , pcHooked = []\n  , ...\n  }\n```\n\n## Golden Test Files\n\n- `test/golden/prime-empty.md` - No tasks\n- `test/golden/prime-typical.md` - Mix of in-progress and ready\n- `test/golden/prime-hooked.md` - With propulsion work\n\n## Acceptance Criteria\n\n- [ ] All unit tests pass\n- [ ] Golden tests for markdown output\n- [ ] Integration test runs successfully in CI","status":"closed","priority":3,"issue_type":"task","created_at":"2026-01-04T16:42:36.727509335-08:00","created_by":"inanna","updated_at":"2026-01-04T17:16:53.856664135-08:00","closed_at":"2026-01-04T17:16:53.856664135-08:00","close_reason":"Closed","dependencies":[{"issue_id":"tidepool-6qa.4","depends_on_id":"tidepool-6qa","type":"parent-child","created_at":"2026-01-04T16:42:36.735731301-08:00","created_by":"inanna"},{"issue_id":"tidepool-6qa.4","depends_on_id":"tidepool-6qa.3","type":"blocks","created_at":"2026-01-04T16:42:46.785883-08:00","created_by":"inanna"}]}
{"id":"tidepool-6qa.5","title":"Add GitHub PR polling to urchin prime","description":"Phase 2: Poll GitHub for in_review beads and auto-close on merge.\n\n## Trigger\n\nWhen `urchin prime` runs, check all beads with:\n- status = in_review\n- has label matching `pr:\\d+`\n\n## Implementation\n\n```haskell\ndata PRStatus = PROpen | PRMerged | PRClosed | PRNotFound\n\ncheckPRStatus :: Text -\u003e Int -\u003e IO PRStatus\n-- Uses: gh pr view \u003cnum\u003e --json state,mergedAt\n\nupdateBeadsFromPR :: BDConfig -\u003e IO [BeadUpdate]\n-- For each in_review bead with pr:N label:\n--   1. Check PR status via gh\n--   2. If merged: close bead, add 'merged' label\n--   3. If closed (not merged): add 'pr-closed' label, leave in_review\n```\n\n## CLI Integration\n\n```bash\nurchin prime              # Includes PR check in output\nurchin prime --no-pr-check # Skip GitHub polling (offline mode)\n```\n\n## Output Addition\n\n```markdown\n## Session Handoff\n\n✓ tidepool-6qa.1 PR #45 merged → closing bead\n⏳ tidepool-6qa.2 PR #46 still open (2 approvals, awaiting merge)\n```\n\n## Dependencies\n\n- Requires `gh` CLI authenticated\n- Requires in_review status (task 6qa.3 adds this)\n\n## Acceptance Criteria\n\n- [ ] Detects merged PRs and closes beads\n- [ ] Handles missing/deleted PRs gracefully\n- [ ] Works offline with --no-pr-check flag\n- [ ] Shows status in prime output","status":"open","priority":3,"issue_type":"task","created_at":"2026-01-04T16:58:41.054076518-08:00","created_by":"inanna","updated_at":"2026-01-04T16:58:41.054076518-08:00","dependencies":[{"issue_id":"tidepool-6qa.5","depends_on_id":"tidepool-6qa","type":"parent-child","created_at":"2026-01-04T16:58:41.060333717-08:00","created_by":"inanna"},{"issue_id":"tidepool-6qa.5","depends_on_id":"tidepool-6qa.4","type":"blocks","created_at":"2026-01-04T16:58:47.999255616-08:00","created_by":"inanna"}]}
{"id":"tidepool-6w1","title":"LSP tooling for tidepool","description":"Build LSP-powered code intelligence tools for the tidepool ecosystem.\n\n## Current State\n\n- `tidepool-lsp-executor` package with lsp-client integration\n- `impact-analysis` CLI tool (v2 graph DSL) - merged PR #126\n- Smoke test against real HLS\n\n## Goals\n\n1. **LSP as graph effect** - Make LSP IO-blind for WASM compatibility\n2. **PR impact analysis** - Automated blast radius assessment\n3. **Context enrichment** - LSP data for urchin prime\n\n## Related\n\n- tidepool-6qa (urchin prime) - consumer of LSP context\n- tidepool-98i (ClaudeCode) - could use LSP for pre-session context\n","status":"open","priority":2,"issue_type":"epic","created_at":"2026-01-04T17:25:55.331573107-08:00","created_by":"inanna","updated_at":"2026-01-04T17:26:58.772534807-08:00"}
{"id":"tidepool-6w1.1","title":"impact-analysis CLI tool","description":"v2 graph DSL CLI tool for analyzing symbol impact using LSP.\n\n## Delivered\n\n- Uses lsp-client for HLS communication\n- Progress/diagnostics notifications for readiness detection\n- JSON and text output formats\n- Cross-platform path handling\n\n## PR\n\nMerged as PR #126\n","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-04T17:27:04.55516354-08:00","created_by":"inanna","updated_at":"2026-01-04T17:27:21.063439636-08:00","closed_at":"2026-01-04T17:27:21.063439636-08:00","close_reason":"Closed","labels":["merged","pr:126"],"dependencies":[{"issue_id":"tidepool-6w1.1","depends_on_id":"tidepool-6w1","type":"parent-child","created_at":"2026-01-04T17:27:04.559367491-08:00","created_by":"inanna"}]}
{"id":"tidepool-6w1.2","title":"LSP as graph effect","description":"Make LSP an IO-blind effect for graph DSL, enabling WASM compatibility.\n\n## Design\n\n```haskell\ndata LSP :: Effect where\n  Hover :: Uri -\u003e Position -\u003e LSP m (Maybe HoverInfo)\n  Definition :: Uri -\u003e Position -\u003e LSP m [Location]\n  References :: Uri -\u003e Position -\u003e LSP m [Location]\n  Diagnostics :: Uri -\u003e LSP m [Diagnostic]\n\n-- Native interpreter (uses lsp-client)\nrunLSPNative :: Session -\u003e Eff (LSP : es) a -\u003e Eff es a\n\n-- WASM interpreter (yields to TypeScript)\nrunLSPWasm :: Eff (LSP : es) a -\u003e Eff (Yield : es) a\n```\n\n## Benefits\n\n- Graphs can use LSP without IO dependency\n- Enables LSP in WASM-compiled agents\n- Testable with mock interpreter\n\n## Depends on\n\n- Current lsp-client integration in tidepool-lsp-executor\n","status":"in_progress","priority":2,"issue_type":"task","created_at":"2026-01-04T17:27:33.465491404-08:00","created_by":"inanna","updated_at":"2026-01-04T20:34:24.968752593-08:00","dependencies":[{"issue_id":"tidepool-6w1.2","depends_on_id":"tidepool-6w1","type":"parent-child","created_at":"2026-01-04T17:27:33.469847895-08:00","created_by":"inanna"}]}
{"id":"tidepool-6w1.3","title":"PR impact analysis integration","description":"Use impact-analysis to assess PR blast radius automatically.\n\n## Use Cases\n\n1. **PR Review** - Show which files/symbols are affected by changes\n2. **Risk Assessment** - Flag PRs touching high-connectivity symbols\n3. **Dependency Chains** - Trace impact through call hierarchies\n\n## Integration Points\n\n- GitHub Actions workflow\n- urchin prime context generation\n- bd PR linkage (pr:N labels)\n\n## Implementation\n\n```bash\n# For each changed symbol in PR diff:\nimpact-analysis --file $file --line $line --col $col --format json\n\n# Aggregate results into blast radius report\n```\n","status":"in_progress","priority":2,"issue_type":"task","created_at":"2026-01-04T17:27:37.401107467-08:00","created_by":"inanna","updated_at":"2026-01-04T20:34:25.14715786-08:00","dependencies":[{"issue_id":"tidepool-6w1.3","depends_on_id":"tidepool-6w1","type":"parent-child","created_at":"2026-01-04T17:27:37.405696239-08:00","created_by":"inanna"}]}
{"id":"tidepool-6w1.4","title":"LSP context enrichment for urchin prime","description":"Enrich urchin prime context with LSP-derived information.\n\n## Context Additions\n\nWhen generating prime context, include:\n- Type signatures for symbols in active beads\n- Call hierarchy for functions being modified\n- Reference counts for impact assessment\n\n## Integration with tidepool-6qa\n\nAdd to PrimeContext:\n```haskell\ndata SymbolContext = SymbolContext\n  { scName :: Text\n  , scType :: Maybe Text        -- from hover\n  , scDefinedAt :: Maybe Location\n  , scReferenceCount :: Int\n  , scCallers :: [Text]         -- incoming calls\n  }\n```\n\n## Dependency\n\n- Requires tidepool-6qa.5 (GitHub polling) for PR context\n- Uses impact-analysis under the hood\n","status":"open","priority":3,"issue_type":"task","created_at":"2026-01-04T17:27:44.464149867-08:00","created_by":"inanna","updated_at":"2026-01-04T17:28:18.252768365-08:00","dependencies":[{"issue_id":"tidepool-6w1.4","depends_on_id":"tidepool-6w1","type":"parent-child","created_at":"2026-01-04T17:27:44.468631907-08:00","created_by":"inanna"}]}
{"id":"tidepool-80t","title":"Observability for Sleeptime","description":"Comprehensive observability infrastructure for sleeptime learning: graph traces, LLM calls, user interactions. Dual-target: Grafana Cloud for deployed workers AND local/native tidepool runs.","status":"open","priority":2,"issue_type":"task","created_at":"2026-01-04T17:40:55.379962214-08:00","created_by":"inanna","updated_at":"2026-01-04T17:40:55.379962214-08:00"}
{"id":"tidepool-80t.1","title":"Local/Native Observability Runner","description":"Make local tidepool runs (DM GUI, Tidying GUI, impact-analysis) push events to Grafana Cloud. Extend tidepool-observability-executor to work outside CF Workers context. Requires: Grafana Cloud credentials handling, OTEL/Loki protocol from native Haskell.","status":"in_progress","priority":2,"issue_type":"task","created_at":"2026-01-04T17:41:03.560643146-08:00","created_by":"inanna","updated_at":"2026-01-04T20:34:24.642368621-08:00","dependencies":[{"issue_id":"tidepool-80t.1","depends_on_id":"tidepool-80t","type":"parent-child","created_at":"2026-01-04T17:41:03.569671133-08:00","created_by":"inanna"}]}
{"id":"tidepool-80t.2","title":"Graph Execution Instrumentation","description":"Auto-instrument runGraph/DispatchGoto with span emission. Every node transition should emit GraphTransition event. Entry/exit spans for graph runs. Works with both CF Workers (existing) and native (new from .1).","status":"in_progress","priority":2,"issue_type":"task","created_at":"2026-01-04T17:41:16.587093103-08:00","created_by":"inanna","updated_at":"2026-01-04T20:34:24.804385905-08:00","dependencies":[{"issue_id":"tidepool-80t.2","depends_on_id":"tidepool-80t","type":"parent-child","created_at":"2026-01-04T17:41:16.591468247-08:00","created_by":"inanna"}]}
{"id":"tidepool-80t.3","title":"LLM Call Instrumentation","description":"Detailed logging of LLM requests/responses. Capture: model, prompt tokens, completion tokens, latency, structured output schema, tool calls. Existing LLMCallEvent type covers most - wire it into LLM effect interpreter.","status":"open","priority":2,"issue_type":"task","created_at":"2026-01-04T17:41:17.018729465-08:00","created_by":"inanna","updated_at":"2026-01-04T17:41:17.018729465-08:00","dependencies":[{"issue_id":"tidepool-80t.3","depends_on_id":"tidepool-80t","type":"parent-child","created_at":"2026-01-04T17:41:17.019386711-08:00","created_by":"inanna"}]}
{"id":"tidepool-80t.4","title":"User Interaction Logging","description":"Log all RequestInput/TelegramAsk interactions. Capture: question text, options presented, user's choice, latency. UserActionEvent type exists - wire into interpreters.","status":"open","priority":2,"issue_type":"task","created_at":"2026-01-04T17:41:17.412255375-08:00","created_by":"inanna","updated_at":"2026-01-04T17:41:17.412255375-08:00","dependencies":[{"issue_id":"tidepool-80t.4","depends_on_id":"tidepool-80t","type":"parent-child","created_at":"2026-01-04T17:41:17.412836554-08:00","created_by":"inanna"}]}
{"id":"tidepool-80t.5","title":"Sleeptime Data Query Interface","description":"Provide sleeptime with ability to query observability data from Grafana/Loki. LogQL queries for: recent graph runs, LLM call patterns, user interaction sequences. This is the consumer side that enables template evolution.","status":"open","priority":2,"issue_type":"task","created_at":"2026-01-04T17:41:17.768014779-08:00","created_by":"inanna","updated_at":"2026-01-04T17:41:17.768014779-08:00","dependencies":[{"issue_id":"tidepool-80t.5","depends_on_id":"tidepool-80t","type":"parent-child","created_at":"2026-01-04T17:41:17.768613529-08:00","created_by":"inanna"}]}
{"id":"tidepool-98i","title":"ClaudeCode graph integration","description":"Integrate ClaudeCode annotation with graph execution. Enables LLM nodes to spawn Claude Code sessions via zellij-cc instead of API calls.","status":"open","priority":2,"issue_type":"epic","created_at":"2026-01-04T15:55:59.559380122-08:00","created_by":"inanna","updated_at":"2026-01-04T15:55:59.559380122-08:00"}
{"id":"tidepool-98i.1","title":"Add Backend + ClaudeCode annotations","description":"Add type-level annotations for Backend selection (CloudflareAI | NativeAnthropic) and ClaudeCode node annotation (model + cwd). PR #123.","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-04T15:58:37.329341858-08:00","created_by":"inanna","updated_at":"2026-01-04T16:06:53.423837893-08:00","closed_at":"2026-01-04T16:06:53.423842743-08:00","external_ref":"gh-123","dependencies":[{"issue_id":"tidepool-98i.1","depends_on_id":"tidepool-98i","type":"parent-child","created_at":"2026-01-04T15:58:37.330420825-08:00","created_by":"inanna"}]}
{"id":"tidepool-98i.2","title":"Implement ClaudeCode executor","description":"Executor that renders template, spawns Claude Code via zellij-cc, parses JSON output. Runs in native-server worktree.","status":"in_progress","priority":2,"issue_type":"task","created_at":"2026-01-04T15:58:37.643377962-08:00","created_by":"inanna","updated_at":"2026-01-04T20:34:25.314914207-08:00","dependencies":[{"issue_id":"tidepool-98i.2","depends_on_id":"tidepool-98i","type":"parent-child","created_at":"2026-01-04T15:58:37.643997221-08:00","created_by":"inanna"}]}
{"id":"tidepool-98i.3","title":"Build dev workflow graph in urchin","description":"Create the first dev workflow graph in ~/dev/urchin that uses BD reads/writes + Haskell logic + ClaudeCode invocation for a local helper.","status":"open","priority":2,"issue_type":"task","created_at":"2026-01-04T15:58:38.045171562-08:00","created_by":"inanna","updated_at":"2026-01-04T15:58:38.045171562-08:00","dependencies":[{"issue_id":"tidepool-98i.3","depends_on_id":"tidepool-98i","type":"parent-child","created_at":"2026-01-04T15:58:38.045754249-08:00","created_by":"inanna"}]}
{"id":"tidepool-98i.4","title":"ClaudeCode session resumption (--resume)","description":"Enable resuming Claude Code sessions via opaque session ID.\n\n## Research (from gastown seances)\n\nGastown pattern:\n- Session IDs are Claude's internal UUIDs\n- Captured via `~/.events.jsonl` with `session_start` events\n- Resume via `claude --fork-session --resume \u003csession-id\u003e`\n- `--fork-session` creates isolated copy (doesn't modify original)\n\n## Implementation\n\n1. **Capture session ID** - ClaudeCodeExec effect returns session_id from spawned Claude\n2. **Store session ID** - Link to bead or graph state (not duplicating transcripts)\n3. **Resume API** - `ClaudeCodeResume session_id prompt` effect operation\n4. **Discovery** - Query mechanism for finding resumable sessions\n\n## Key Files (gastown reference)\n\n- `~/dev/gastown/internal/cmd/seance.go` - seance command\n- `~/dev/gastown/internal/session/names.go` - readSessionID()\n- `~/dev/gastown/docs/hop/decisions/009-session-events-architecture.md` - design rationale\n\n## Depends on\n\n- tidepool-98i.2 (ClaudeCode executor must exist first)","status":"in_progress","priority":2,"issue_type":"task","created_at":"2026-01-04T20:32:33.919639757-08:00","created_by":"inanna","updated_at":"2026-01-04T20:34:25.637862119-08:00","dependencies":[{"issue_id":"tidepool-98i.4","depends_on_id":"tidepool-98i","type":"parent-child","created_at":"2026-01-04T20:32:33.920734388-08:00","created_by":"inanna"},{"issue_id":"tidepool-98i.4","depends_on_id":"tidepool-98i.2","type":"blocks","created_at":"2026-01-04T20:32:52.321790768-08:00","created_by":"inanna"}]}
{"id":"tidepool-w51","title":"DM Native Execution","description":"Add native execution support for DMGraph while keeping WASM/Cloudflare deployment working. Uses tidepool's native GUI tooling (WebSocket + SolidJS frontend).","status":"open","priority":2,"issue_type":"epic","created_at":"2026-01-04T19:53:16.722707967-08:00","created_by":"inanna","updated_at":"2026-01-04T19:53:16.722707967-08:00"}
{"id":"tidepool-w51.1","title":"Abstract effect layer (DMEffect type class)","description":"Created Automat/DM/Effect.hs with DMEffect type class that abstracts over WASM and native execution. Completed in shoal-automat.","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-04T19:53:22.703521558-08:00","created_by":"inanna","updated_at":"2026-01-04T19:53:28.342671793-08:00","closed_at":"2026-01-04T19:53:28.342671793-08:00","close_reason":"Closed","dependencies":[{"issue_id":"tidepool-w51.1","depends_on_id":"tidepool-w51","type":"parent-child","created_at":"2026-01-04T19:53:22.708332465-08:00","created_by":"inanna"}]}
{"id":"tidepool-w51.2","title":"WASM and Native effect instances","description":"Created Automat/DM/Effect/Wasm.hs and Automat/DM/Effect/Native.hs. Completed.","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-04T19:53:28.45048782-08:00","created_by":"inanna","updated_at":"2026-01-04T19:53:28.563677464-08:00","closed_at":"2026-01-04T19:53:28.563677464-08:00","close_reason":"Closed","dependencies":[{"issue_id":"tidepool-w51.2","depends_on_id":"tidepool-w51","type":"parent-child","created_at":"2026-01-04T19:53:28.451308603-08:00","created_by":"inanna"}]}
{"id":"tidepool-w51.3","title":"Runner modules (Wasm.hs, Native.hs)","description":"Created Automat/DM/Runner/Wasm.hs and Automat/DM/Runner/Native.hs. Completed.","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-04T19:53:35.920852337-08:00","created_by":"inanna","updated_at":"2026-01-04T19:53:36.061569973-08:00","closed_at":"2026-01-04T19:53:36.061569973-08:00","close_reason":"Closed","dependencies":[{"issue_id":"tidepool-w51.3","depends_on_id":"tidepool-w51","type":"parent-child","created_at":"2026-01-04T19:53:35.927720429-08:00","created_by":"inanna"}]}
{"id":"tidepool-w51.4","title":"Native server entry point (app/DM/Main.hs)","description":"Created dm-native executable using tidepool-native-server. Uses simplified DM agent until handlers are made polymorphic. Completed.","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-04T19:53:36.200010568-08:00","created_by":"inanna","updated_at":"2026-01-04T19:53:36.323990529-08:00","closed_at":"2026-01-04T19:53:36.323990529-08:00","close_reason":"Closed","dependencies":[{"issue_id":"tidepool-w51.4","depends_on_id":"tidepool-w51","type":"parent-child","created_at":"2026-01-04T19:53:36.200606836-08:00","created_by":"inanna"}]}
{"id":"tidepool-w51.5","title":"Make handlers polymorphic","description":"Change handler signatures from explicit WasmM to use DMEffect m =\u003e constraint. This allows same handler code to work with both WASM and native backends.","status":"in_progress","priority":2,"issue_type":"task","created_at":"2026-01-04T19:53:45.15757-08:00","created_by":"inanna","updated_at":"2026-01-04T20:34:25.466805438-08:00","dependencies":[{"issue_id":"tidepool-w51.5","depends_on_id":"tidepool-w51","type":"parent-child","created_at":"2026-01-04T19:53:45.162197482-08:00","created_by":"inanna"}]}
{"id":"tidepool-w51.6","title":"Wire DM graph to native runner","description":"Once handlers are polymorphic, connect the actual graph handlers to the native runner instead of the simplified agent.","status":"open","priority":2,"issue_type":"task","created_at":"2026-01-04T19:53:45.303163599-08:00","created_by":"inanna","updated_at":"2026-01-04T19:53:45.303163599-08:00","dependencies":[{"issue_id":"tidepool-w51.6","depends_on_id":"tidepool-w51","type":"parent-child","created_at":"2026-01-04T19:53:45.303873684-08:00","created_by":"inanna"}]}
{"id":"tidepool-w51.7","title":"Test full DM flow natively","description":"Run complete DM session through native execution with LLM calls and state management.","status":"open","priority":2,"issue_type":"task","created_at":"2026-01-04T19:53:45.429068144-08:00","created_by":"inanna","updated_at":"2026-01-04T19:53:45.429068144-08:00","dependencies":[{"issue_id":"tidepool-w51.7","depends_on_id":"tidepool-w51","type":"parent-child","created_at":"2026-01-04T19:53:45.429725773-08:00","created_by":"inanna"}]}
