cabal-version: 3.4
name: unified
version: 0.1.0.0
license:            BSD-3-Clause
author:             Inanna Malick
maintainer:         Inanna Malick
build-type: Simple

common shared
    default-language: GHC2021
    default-extensions:
        AllowAmbiguousTypes
        DataKinds
        DeriveAnyClass
        DeriveGeneric
        DerivingStrategies
        FlexibleContexts
        FlexibleInstances
        ForeignFunctionInterface
        GADTs
        LambdaCase
        OverloadedStrings
        ScopedTypeVariables
        TypeApplications
        TypeFamilies
        TypeOperators
        UndecidableInstances
        ImportQualifiedPost
    build-depends:
        base >= 4.16 && < 5,
        bytestring,
        text,
        aeson,
        freer-simple >= 1.2,
        unordered-containers,
        containers,
        time,
        directory,
        filepath

executable wasm-guest-unified
    import: shared
    hs-source-dirs: . ../../lib
    main-is: Main.hs
    other-modules:
        AllRoles
        TLRole
        DevRole
        WorkerRole
        HttpDevHooks
    ghc-options: -no-hs-main -optl-mexec-model=reactor -optl-Wl,--export=hs_init -optl-Wl,--export=handle_mcp_call -optl-Wl,--export=handle_pre_tool_use -optl-Wl,--export=handle_list_tools -optl-Wl,--export=resume -optl-Wl,--allow-undefined
    build-depends:
        base,
        wasm-guest:wasm-guest-internal,
        exomonad-pdk,
        exomonad-proto,
        proto3-runtime
